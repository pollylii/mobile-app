{"remainingRequest":"C:\\polly\\polly\\linjiashop\\linjiashop-mobile\\node_modules\\babel-loader\\lib\\index.js!C:\\polly\\polly\\linjiashop\\linjiashop-mobile\\src\\view\\goods\\goods.js?vue&type=script&lang=js&","dependencies":[{"path":"C:\\polly\\polly\\linjiashop\\linjiashop-mobile\\src\\view\\goods\\goods.js","mtime":1588337555521},{"path":"C:\\polly\\polly\\linjiashop\\linjiashop-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\polly\\polly\\linjiashop\\linjiashop-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/polly/polly/linjiashop/linjiashop-mobile/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"vant/es/toast/style\");\n\nvar _toast = _interopRequireDefault(require(\"vant/es/toast\"));\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"C:/polly/polly/linjiashop/linjiashop-mobile/node_modules/@babel/runtime/helpers/defineProperty\"));\n\nrequire(\"vant/es/button/style\");\n\nvar _button = _interopRequireDefault(require(\"vant/es/button\"));\n\nrequire(\"vant/es/sku/style\");\n\nvar _sku = _interopRequireDefault(require(\"vant/es/sku\"));\n\nrequire(\"vant/es/tabbar-item/style\");\n\nvar _tabbarItem = _interopRequireDefault(require(\"vant/es/tabbar-item\"));\n\nrequire(\"vant/es/tabbar/style\");\n\nvar _tabbar = _interopRequireDefault(require(\"vant/es/tabbar\"));\n\nrequire(\"vant/es/goods-action-button/style\");\n\nvar _goodsActionButton = _interopRequireDefault(require(\"vant/es/goods-action-button\"));\n\nrequire(\"vant/es/goods-action-icon/style\");\n\nvar _goodsActionIcon = _interopRequireDefault(require(\"vant/es/goods-action-icon\"));\n\nrequire(\"vant/es/goods-action/style\");\n\nvar _goodsAction = _interopRequireDefault(require(\"vant/es/goods-action\"));\n\nrequire(\"vant/es/swipe-item/style\");\n\nvar _swipeItem = _interopRequireDefault(require(\"vant/es/swipe-item\"));\n\nrequire(\"vant/es/swipe/style\");\n\nvar _swipe = _interopRequireDefault(require(\"vant/es/swipe\"));\n\nrequire(\"vant/es/cell-group/style\");\n\nvar _cellGroup = _interopRequireDefault(require(\"vant/es/cell-group\"));\n\nrequire(\"vant/es/cell/style\");\n\nvar _cell = _interopRequireDefault(require(\"vant/es/cell\"));\n\nrequire(\"vant/es/icon/style\");\n\nvar _icon = _interopRequireDefault(require(\"vant/es/icon\"));\n\nrequire(\"vant/es/col/style\");\n\nvar _col = _interopRequireDefault(require(\"vant/es/col\"));\n\nrequire(\"vant/es/tag/style\");\n\nvar _tag = _interopRequireDefault(require(\"vant/es/tag\"));\n\nvar _goods = _interopRequireDefault(require(\"@/api/goods\"));\n\nvar _cart = _interopRequireDefault(require(\"@/api/cart\"));\n\nvar _favorite = _interopRequireDefault(require(\"@/api/favorite\"));\n\nvar _storage = _interopRequireDefault(require(\"@/utils/storage\"));\n\nvar _components;\n\nvar baseApi = process.env.VUE_APP_BASE_API;\nvar _default = {\n  components: (_components = {}, (0, _defineProperty2.default)(_components, _tag.default.name, _tag.default), (0, _defineProperty2.default)(_components, _col.default.name, _col.default), (0, _defineProperty2.default)(_components, _icon.default.name, _icon.default), (0, _defineProperty2.default)(_components, _cell.default.name, _cell.default), (0, _defineProperty2.default)(_components, _cellGroup.default.name, _cellGroup.default), (0, _defineProperty2.default)(_components, _swipe.default.name, _swipe.default), (0, _defineProperty2.default)(_components, _swipeItem.default.name, _swipeItem.default), (0, _defineProperty2.default)(_components, _goodsAction.default.name, _goodsAction.default), (0, _defineProperty2.default)(_components, _goodsActionIcon.default.name, _goodsActionIcon.default), (0, _defineProperty2.default)(_components, _goodsActionButton.default.name, _goodsActionButton.default), (0, _defineProperty2.default)(_components, _tabbar.default.name, _tabbar.default), (0, _defineProperty2.default)(_components, _tabbarItem.default.name, _tabbarItem.default), (0, _defineProperty2.default)(_components, _sku.default.name, _sku.default), (0, _defineProperty2.default)(_components, _button.default.name, _button.default), _components),\n  data: function data() {\n    return {\n      ifLike: false,\n      likeColor: 'black',\n      cartCount: '',\n      showSku: false,\n      sku: {\n        tree: [],\n        list: [],\n        price: '0',\n        // 默认价格（单位元）\n        stock_num: 20,\n        // 商品总库存\n        collection_id: 0,\n        // 无规格商品 skuId 取 collection_id，否则取所选 sku 组合对应的 id\n        none_sku: false,\n        // 是否无规格商品\n        hide_stock: false // 是否隐藏剩余库存\n\n      },\n      offline: false,\n      goods: {\n        name: '',\n        price: 0,\n        express: '免运费',\n        remain: 0,\n        thumb: []\n      }\n    };\n  },\n  created: function created() {\n    this.init();\n  },\n  computed: {},\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      var id = this.$route.params.id;\n\n      _goods.default.getGoods(id).then(function (response) {\n        var goods = response.data.goods;\n        _this.offline = !goods.isOnSale;\n        var sku = response.data.sku;\n        sku.price = (sku.price / 100).toFixed(2);\n        _this.sku = sku;\n        goods.thumb = new Array();\n        goods.picture = baseApi + '/file/getImgStream?idFile=' + goods.pic;\n        var gallery = goods.gallery.split(',');\n\n        for (var index in gallery) {\n          goods.thumb.push(baseApi + '/file/getImgStream?idFile=' + gallery[index]);\n        }\n\n        _this.goods = goods;\n\n        var user = _storage.default.getUser();\n\n        if (user.nickName) {\n          //获取当前用户购物车商品数量\n          _cart.default.count().then(function (response) {\n            _this.cartCount = response.data === 0 ? '' : response.data;\n          }); //判断当前用户是否收藏该产品\n\n\n          _favorite.default.ifLike(_this.goods.id).then(function (response) {\n            if (response.data === true) {\n              _this.likeColor = 'red';\n              _this.ifLike = true;\n            }\n          });\n        }\n      }).catch(function (err) {\n        console.log('err', err);\n        (0, _toast.default)(err);\n      });\n    },\n    toHome: function toHome() {\n      this.$router.push('/index');\n    },\n    formatPrice: function formatPrice() {\n      return '¥' + (this.goods.price / 100).toFixed(2);\n    },\n    goToCart: function goToCart() {\n      this.$router.push('/cart');\n    },\n    addCart: function addCart() {\n      this.showSku = true;\n    },\n    buy: function buy() {\n      this.showSku = true;\n    },\n    sorry: function sorry() {\n      (0, _toast.default)('敬请期待');\n    },\n    like: function like() {\n      var _this2 = this;\n\n      if (this.ifLike === false) {\n        _favorite.default.add(this.goods.id).then(function (response) {\n          (0, _toast.default)('收藏成功');\n          _this2.ifLike = true;\n          _this2.likeColor = 'red';\n        });\n      }\n    },\n    onBuyClicked: function onBuyClicked(skuData) {\n      var _this3 = this;\n\n      var cartData = {\n        idGoods: skuData.goodsId,\n        idSku: this.sku.none_sku ? '' : skuData.selectedSkuComb.id,\n        count: skuData.selectedNum\n      };\n\n      _cart.default.add(cartData).then(function (response) {\n        _this3.$router.push('/cart');\n\n        _this3.showSku = false;\n      });\n    },\n    onAddCartClicked: function onAddCartClicked(skuData) {\n      var _this4 = this;\n\n      var cartData = {\n        idGoods: skuData.goodsId,\n        idSku: this.sku.none_sku ? '' : skuData.selectedSkuComb.id,\n        count: skuData.selectedNum\n      };\n\n      _cart.default.add(cartData).then(function (response) {\n        console.log(response);\n\n        _toast.default.success('已加入到购物车');\n\n        _this4.showSku = false;\n        _this4.cartCount += response.data;\n      });\n    }\n  }\n};\nexports.default = _default;",null]}